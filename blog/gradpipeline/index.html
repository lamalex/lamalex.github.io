<!DOCTYPE html>
<html>
    

<head>
    <title>Alex Launi, UNO enthusiast</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta property="og:site_name" content="https:&#x2F;&#x2F;launi.me" |safe />
    <meta property="og:title" content="Home - https:&#x2F;&#x2F;launi.me" |safe />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https:&#x2F;&#x2F;launi.me&#x2F;blog&#x2F;gradpipeline&#x2F;" />
    <meta name="twitter:creator" content="@rhonda_jeremy" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" type="text/css" href="https://launi.me/style.css" />
    
    
</head>

<body class="party" style>
    <header role="banner" class="Site-head pad-top-500">
        <div class="wrapper wrapper-lg">
            <div class="Site-head__inner box-flex space-between align-center">
                <nav class="nav">
                    <ul class="nav__list box-flex align-center md:space-before">
                        <li class="nav__item">
                            <a href="https://launi.me" aria-current="page" class="nav__item-hover"
                                data-id="blog">
                                <span class="nav__item-hover-inner" data-hover="blog">
                                    home
                                </span>
                            </a>
                        </li>
                        <li class="nav__item">
                            <a href="https:&#x2F;&#x2F;launi.me&#x2F;blog" aria-current="page" class="nav__item-hover"
                                data-id="blog">
                                <span class="nav__item-hover-inner" data-hover="blog">
                                    blog
                                </span>
                            </a>
                        </li>
                        <li class="nav__item">
                            <a href="https:&#x2F;&#x2F;launi.me&#x2F;cv" aria-current="page" class="nav__item-hover"
                                data-id="cv">
                                <span class="nav__item-hover-inner" data-hover="blog">
                                    cv
                                </span>
                            </a>
                        </li>
                    </ul>
                </nav>

                <div class="theme-switch-wrapper">
                    ðŸŽ‰
                    <label class="theme-switch" for="checkbox">
                        <input type="checkbox" id="checkbox" />
                        <div class="slider round"></div>
                    </label>
                    ðŸ’€
                </div>

            </div>
        </div>
    </header>
    <main id="main-content" tabindex="-1" class="content">
        <div class="pad-before-xlg">
            <div class="wrapper wrapper-sm pad-before">

                <header class="Intro pad-around">
                    <div class="Intro__inner inner-wrapper">
                        <div class="Intro__copy">
                            
<h1 class="Intro__heading h3">Grad students should have a CI&#x2F;CD pipeline</h1>
    <div class="Intro__byline h6">
        <p>This semester I'm fortunate enough to take part in a pilot course where we will be developing curriculum for an undergrad software engineering course. This new course is meant as a follow on to Old Dominions required undergrad software engineering, CS350. In grad school I work on an iOS app written mostly in Swift with a C library generated from Matlab. We're working on building a system to help physical therapists monitor their patients progress through a wearable. My work focuses on building user interfaces that via game mechanics implicitly nudge users towards meeting certain range-of-motion goals. We're basically building a game in which your range-of-motion is the primary interface. I would say more, but we have multiple papers pending review!</p>
<p>â€‹</p>
<p>I now have a continuous delivery system in place, but prior I was just off on my own building without input from my stakeholders (my research PI).</p>
<p>â€‹</p>
<h2 id="why-do-grad-students-need-ci">Why do grad students need CI?</h2>
<p>I had been assuming that my advisor was checking GitHub, pulling down my changes, running the application, and I took not getting feedback about the app as good feedback. The reality is that I was working mostly in isolation. There was too much friction for getting my work into the hands of my advisor for testing. By the time I realized this I had a fully working prototype and thought we were ready to start using it to collect data! I packaged everything up, set up TestFlight for distribution and added my advisor so she could install a release build on her phone and test it.</p>
<p>â€‹</p>
<p>Our next meeting was a disaster. She hated it! And in retrospect, fair enough. It didn't succeed at its goal. I'd gotten too bogged down in the weeds, I'd lost sight of whether or not my tool was serving its purpose.  A lot of what I had worked on was still usable, and all the time I'd taken to make the application architecture well designed would pay off as I refactored the interface, but I could have saved myself a month if I had just <strong>gotten my application to my stakeholders early</strong>. This seems obvious. I've read <a href="https://itrevolution.com/the-devops-handbook/">The DevOps handbook</a>, and I was testing and running tests, but I hadn't made the connection that my PI is not another developer; during development she is the customer.</p>
<p>â€‹</p>
<h2 id="what-i-built">What I built</h2>
<p>If you're a student, you have access to the <a href="https://education.github.com/pack">GitHub Student Developer pack</a>. This is a wonderful resource for student developers that gives you access to a plethora of industry tools for <strong>free</strong>. For example, a free GitHub pro account, and <a href="https://education.travis-ci.com">Travis CI</a> gives you free unlimited private builds, 2 years of a pro datadog account, mailgun, and a ton more! It's an awesome program. Travis is really easy to use. You just connect your github account and give it <code>repo</code> scope so it can access your private repositories. Then you write a small .yml configuration. Mine looks like this:</p>
<pre style="background-color:#fafafa;">
<code class="language-yaml" data-lang="yaml"><span style="color:#399ee6;">language</span><span style="color:#61676ccc;">: </span><span style="color:#399ee6;">swift
os</span><span style="color:#61676ccc;">:
  </span><span style="color:#61676c;">- </span><span style="color:#399ee6;">osx
cache</span><span style="color:#61676ccc;">:
  </span><span style="color:#399ee6;">bundler</span><span style="color:#61676ccc;">: </span><span style="color:#ff8f40;">true
  </span><span style="color:#399ee6;">cocoapods</span><span style="color:#61676ccc;">: </span><span style="color:#ff8f40;">true
</span><span style="color:#399ee6;">osx_image</span><span style="color:#61676ccc;">: </span><span style="color:#399ee6;">xcode11.5
install</span><span style="color:#61676ccc;">:
  </span><span style="color:#61676c;">- </span><span style="color:#399ee6;">bundle install
  </span><span style="color:#61676c;">- </span><span style="color:#399ee6;">pod install
script</span><span style="color:#61676ccc;">:
  </span><span style="color:#61676c;">- </span><span style="color:#399ee6;">bundle exec danger
  </span><span style="color:#61676c;">- </span><span style="color:#399ee6;">bundle exec fastlane test
  </span><span style="color:#61676c;">- </span><span style="color:#86b300;">&#39;if [ &quot;$TRAVIS_PULL_REQUEST&quot; = &quot;false&quot; ]; then bash ./scripts/travis-deploy.sh; fi&#39;
</span><span style="color:#399ee6;">xcode_project</span><span style="color:#61676ccc;">: </span><span style="color:#86b300;">liftright.xcworkspace </span><span style="font-style:italic;color:#abb0b6;"># path to your xcodeproj folder
</span><span style="color:#399ee6;">xcode_scheme</span><span style="color:#61676ccc;">: </span><span style="color:#399ee6;">liftrightTests
xcode_destination</span><span style="color:#61676ccc;">: </span><span style="color:#86b300;">platform=iOS Simulator,OS=13.0,name=iPhone 11 Pro, iPhone 8
</span></code></pre>
<p>This will run danger (which lints and checks for obviously wrong things in a pull request), then runs my test suite, and finally if not a pull request branch runs a script to deploy straight to TestFlight, where my PI will get a notification on her phone that I made an update. This script is really straight forward. </p>
<pre style="background-color:#fafafa;">
<code class="language-bash" data-lang="bash"><span style="font-style:italic;color:#abb0b6;">#!/bin/bash
</span><span style="color:#f07171;">set </span><span style="color:#ff8f40;">-ev

</span><span style="font-style:italic;color:#abb0b6;"># We only want to push from trunk.
# Did you know emojis are valid in git branch names?
</span><span style="color:#61676c;">if </span><span style="color:#fa6e32;">[ </span><span style="color:#86b300;">&quot;$</span><span style="color:#61676c;">{TRAVIS_BRANCH}</span><span style="color:#86b300;">&quot;</span><span style="color:#61676c;"> != </span><span style="color:#86b300;">&quot;game-ui-ðŸš€&quot; </span><span style="color:#fa6e32;">]</span><span style="color:#ed9366;">; </span><span style="color:#fa6e32;">then
    </span><span style="color:#f07171;">exit</span><span style="color:#61676c;"> 0
</span><span style="color:#fa6e32;">fi

</span><span style="font-style:italic;color:#abb0b6;"># We bump the build number to today&#39;s date so we can be sure
# that we supercede the newest version in TestFlight.
</span><span style="color:#61676c;">buildNumber=$(</span><span style="color:#f29718;">date</span><span style="color:#61676c;"> +</span><span style="color:#86b300;">&quot;%Y.%m.%d.%H%M%S&quot;</span><span style="color:#61676c;">)
</span><span style="color:#f29718;">/usr/libexec/PlistBuddy</span><span style="color:#ff8f40;"> -c </span><span style="color:#86b300;">&quot;Set :CFBundleVersion $</span><span style="color:#61676c;">buildNumber</span><span style="color:#86b300;">&quot;</span><span style="color:#61676c;"> liftright/Info.plist

</span><span style="font-style:italic;color:#abb0b6;"># We have 2 deploy targets. Staging is for development builds.
# Extra debugging might be enabled, 
# data is logged to a more volatile server, etc.
# If the commit has been tagged as &quot;release&quot; 
# then it gets pushed to the server for our actual users
</span><span style="color:#61676c;">if </span><span style="color:#fa6e32;">[ </span><span style="color:#86b300;">&quot;$</span><span style="color:#61676c;">{TRAVIS_TAG}</span><span style="color:#86b300;">&quot;</span><span style="color:#61676c;"> = </span><span style="color:#86b300;">&quot;release&quot; </span><span style="color:#fa6e32;">]</span><span style="color:#ed9366;">; </span><span style="color:#fa6e32;">then
    </span><span style="color:#f29718;">bundle</span><span style="color:#61676c;"> exec fastlane release
</span><span style="color:#fa6e32;">else
    </span><span style="color:#f29718;">bundle</span><span style="color:#61676c;"> exec fastlane staging
</span><span style="color:#fa6e32;">fi
</span></code></pre>
<p>And the final piece of the puzzle is <a href="https://fastlane.tools">Fastlane</a> which is an
all-in-one tool for managing iOS and android deployment. I'm using fastlane for
test running, managing signing certificates, and deploying to staging/production.</p>
<pre style="background-color:#fafafa;">
<code class="language-ruby" data-lang="ruby"><span style="font-style:italic;color:#abb0b6;"># This file contains the fastlane.tools configuration
# You can find the documentation at https://docs.fastlane.tools
#
# For a list of all available actions, check out
#
#     https://docs.fastlane.tools/actions
#
# For a list of all available plugins, check out
#
#     https://docs.fastlane.tools/plugins/available-plugins
#

</span><span style="color:#61676c;">setup_travis
default_platform(</span><span style="color:#86b300;">:ios</span><span style="color:#61676c;">)

platform </span><span style="color:#86b300;">:ios </span><span style="color:#fa6e32;">do
  </span><span style="color:#f29718;">$app_ids </span><span style="color:#ed9366;">= </span><span style="color:#61676c;">{
    </span><span style="color:#86b300;">:nightly </span><span style="color:#61676ccc;">=&gt; </span><span style="color:#86b300;">&quot;edu.odu.cs.liftright.nightly&quot;</span><span style="color:#61676ccc;">,
    </span><span style="color:#86b300;">:staging </span><span style="color:#61676ccc;">=&gt; </span><span style="color:#86b300;">&quot;edu.odu.cs.liftright.staging&quot;</span><span style="color:#61676ccc;">,
    </span><span style="color:#86b300;">:release </span><span style="color:#61676ccc;">=&gt; </span><span style="color:#86b300;">&quot;edu.odu.cs.liftright&quot;
  </span><span style="color:#61676c;">}
  
  </span><span style="color:#fa6e32;">def </span><span style="color:#f29718;">prepare_match</span><span style="color:#61676c;">(</span><span style="color:#ff8f40;">ro</span><span style="color:#ed9366;">=</span><span style="color:#ff8f40;">true</span><span style="color:#61676c;">)
    [</span><span style="color:#86b300;">&quot;development&quot;</span><span style="color:#61676ccc;">, </span><span style="color:#86b300;">&quot;adhoc&quot;</span><span style="color:#61676ccc;">, </span><span style="color:#86b300;">&quot;appstore&quot;</span><span style="color:#61676c;">]</span><span style="color:#ed9366;">.</span><span style="color:#61676c;">each </span><span style="color:#fa6e32;">do </span><span style="color:#61676c;">|</span><span style="color:#ff8f40;">type</span><span style="color:#61676c;">|
      </span><span style="color:#f07171;">match</span><span style="color:#61676c;">(</span><span style="color:#86b300;">type:</span><span style="color:#61676c;"> type</span><span style="color:#61676ccc;">, </span><span style="color:#86b300;">readonly:</span><span style="color:#61676c;"> ro</span><span style="color:#61676ccc;">, </span><span style="color:#86b300;">app_identifier: </span><span style="color:#f29718;">$app_ids</span><span style="color:#ed9366;">.</span><span style="color:#61676c;">values)
    </span><span style="color:#fa6e32;">end
  end
  
  def </span><span style="color:#f29718;">lr_build_app</span><span style="color:#61676c;">(</span><span style="color:#ff8f40;">scheme</span><span style="color:#61676ccc;">:, </span><span style="color:#ff8f40;">config</span><span style="color:#61676ccc;">:</span><span style="color:#61676c;">)
    build_app(</span><span style="color:#86b300;">workspace: &quot;liftright.xcworkspace&quot;</span><span style="color:#61676ccc;">, </span><span style="color:#86b300;">scheme:</span><span style="color:#61676c;"> scheme</span><span style="color:#61676ccc;">, </span><span style="color:#86b300;">configuration:</span><span style="color:#61676c;"> config)
  </span><span style="color:#fa6e32;">end

  def </span><span style="color:#f29718;">lr_upload_beta</span><span style="color:#61676c;">(</span><span style="color:#ff8f40;">app_id</span><span style="color:#61676c;">)
    cl </span><span style="color:#ed9366;">= </span><span style="color:#86b300;">`git log --max-count=1 --format=&quot;%B&quot;`
</span><span style="color:#61676c;">    upload_to_testflight(</span><span style="color:#86b300;">app_identifier:</span><span style="color:#61676c;"> app_id</span><span style="color:#61676ccc;">, </span><span style="color:#86b300;">skip_waiting_for_build_processing: </span><span style="color:#ff8f40;">true</span><span style="color:#61676ccc;">, </span><span style="color:#86b300;">changelog:</span><span style="color:#61676c;"> cl)
  </span><span style="color:#fa6e32;">end

</span><span style="color:#61676c;">  lane </span><span style="color:#86b300;">:test </span><span style="color:#fa6e32;">do
</span><span style="color:#61676c;">    run_tests(</span><span style="color:#86b300;">scheme: &quot;liftright&quot;</span><span style="color:#61676c;">)
  </span><span style="color:#fa6e32;">end
  
</span><span style="color:#61676c;">  lane </span><span style="color:#86b300;">:staging </span><span style="color:#fa6e32;">do
</span><span style="color:#61676c;">    prepare_match
    lr_build_app(</span><span style="color:#86b300;">scheme: &quot;LiftRight [Staging]&quot;</span><span style="color:#61676ccc;">, </span><span style="color:#86b300;">config: &quot;Staging [Release]&quot;</span><span style="color:#61676c;">)
    lr_upload_beta(</span><span style="color:#f29718;">$app_ids</span><span style="color:#61676c;">[</span><span style="color:#86b300;">:staging</span><span style="color:#61676c;">])
  </span><span style="color:#fa6e32;">end

</span><span style="color:#61676c;">  lane </span><span style="color:#86b300;">:release </span><span style="color:#fa6e32;">do
</span><span style="color:#61676c;">    prepare_match
    lr_build_app(</span><span style="color:#86b300;">scheme: &quot;LiftRight [Production]&quot;</span><span style="color:#61676ccc;">, </span><span style="color:#86b300;">config: &quot;Production [Release]&quot;</span><span style="color:#61676c;">)
    lr_upload_beta(</span><span style="color:#f29718;">$app_ids</span><span style="color:#61676c;">[</span><span style="color:#86b300;">:release</span><span style="color:#61676c;">])
  </span><span style="color:#fa6e32;">end

</span><span style="color:#61676c;">  lane </span><span style="color:#86b300;">:certificates </span><span style="color:#fa6e32;">do
</span><span style="color:#61676c;">    prepare_match(False)
  </span><span style="color:#fa6e32;">end
end
</span></code></pre>
<p>This little ditty does checks out signing certificates, builds the specified configuration, and uploads to TestFlight! It also attaches the commit message off of the latest commit as a changelog so recipients can get an idea of what changed. When I approve a PR for merging I merge/squash and rewrite this commit message to be meaningful for an end user.</p>
<p>â€‹</p>
<h2 id="the-result">The result</h2>
<p>We're going live this month! This flow enabled a fast feedback look from my work to my PI, and back. Now I could iterate and get verification on my ideas. <strong>This is the whole idea of incremental development!</strong> There's a good reason we moved away from the waterfall model as an industry. I think when we're working on (more or less) solo projects it's easy to lose sight of why development methodologies were designed, but if we do a little introspection and consider or <em>processes</em> as well as our product, we can build things better, and faster.</p>

    </div> 

                        </div>
                    </div>
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" role="decorative"
                        aria-hidden="true" viewBox="0 0 134 55.5" overflow="visible" class="Intro__svg">
                        <defs>
                            <pattern x="-257.8" y="0" width="5" height="5" patternUnits="userSpaceOnUse"
                                id="dot-pattern" viewBox="0 -8 8 8" overflow="visible">
                                <rect y="-8" width="8" height="8" fill="none"></rect>
                                <ellipse cx="4" cy="-4" rx="0.05" ry="1" fill="var(--color-dark)"
                                    stroke="var(--color-dark)" stroke-miterlimit="10" />
                            </pattern>
                        </defs>
                        <pattern id="SVGID_1_" xlink:href="#dot-pattern" patternTransform="translate(-1.3637 4.2113)" />
                        <rect width="133.9" height="100" fill="url(#SVGID_1_)" />
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" role="decorative"
                        aria-hidden="true" viewBox="0 0 134 55.5" overflow="visible" class="Intro__psvg">
                        <path d="m0,0 q25,-50 100,100 L-25,100" />
                        <ellipse cx="15" cy="17" rx="12" ry="20" fill="var(--color-death-face)"
                            transform="rotate(-16)" />
                    </svg>
                </header>

                <div class="pad-around-sm flare">
                    
                </div>
            </div>
        </div>
    </main>
    <script defer="defer" src="https://launi.me/scripts/main.js"></script>
    
</body>
                    
</html>
